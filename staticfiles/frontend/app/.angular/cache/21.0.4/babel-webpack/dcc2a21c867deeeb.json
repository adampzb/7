{"ast":null,"code":"import { environment } from '@discussit/env/environment';\nimport { ReportDialogComponent } from '@discussit/app/components/report-dialog/report-dialog.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@discussit/core/services/post/post.service\";\nimport * as i2 from \"@angular/material/dialog\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/material/button\";\nimport * as i5 from \"@angular/material/card\";\nimport * as i6 from \"@angular/material/icon\";\nimport * as i7 from \"@angular/material/menu\";\nimport * as i8 from \"@angular/router\";\nimport * as i9 from \"@discussit/core/pipes/safe-content/safe-content.pipe\";\nimport * as i10 from \"@discussit/core/pipes/time-since/time-since.pipe\";\nconst _c0 = a0 => ({\n  \"archived-card\": a0\n});\nconst _c1 = a0 => ({\n  \"active-icon\": a0\n});\nconst _c2 = a0 => [\"user\", a0];\nconst _c3 = a0 => [\"\", a0];\nconst _c4 = a0 => [\"group\", a0];\nfunction PostComponent_span_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 21)(1, \"a\", 13);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(2, _c4, ctx_r1.post.group.id));\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\"g/\", ctx_r1.post.group.name, \" .\");\n  }\n}\nfunction PostComponent_ng_container_42_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelement(1, \"span\", 22);\n    i0.ɵɵpipe(2, \"slice\");\n    i0.ɵɵpipe(3, \"safeContent\");\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"innerHtml\", i0.ɵɵpipeBind1(3, 5, i0.ɵɵpipeBind3(2, 1, ctx_r1.post.content, 0, 300)), i0.ɵɵsanitizeHtml);\n  }\n}\nfunction PostComponent_ng_container_43_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelement(1, \"span\", 22);\n    i0.ɵɵpipe(2, \"safeContent\");\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"innerHtml\", i0.ɵɵpipeBind1(2, 1, ctx_r1.post.content), i0.ɵɵsanitizeHtml);\n  }\n}\nfunction PostComponent_ng_container_44_ng_container_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.post.comments, \" comments \");\n  }\n}\nfunction PostComponent_ng_container_44_ng_template_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtext(0, \" Add comment \");\n  }\n}\nfunction PostComponent_ng_container_44_ng_container_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"mat-icon\", 29);\n    i0.ɵɵtext(2, \"bookmark\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n}\nfunction PostComponent_ng_container_44_ng_template_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-icon\", 29);\n    i0.ɵɵtext(1, \"bookmark_border\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction PostComponent_ng_container_44_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 23)(2, \"a\", 13)(3, \"mat-icon\", 24);\n    i0.ɵɵtext(4, \"insert_comment\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"span\", 25);\n    i0.ɵɵtemplate(6, PostComponent_ng_container_44_ng_container_6_Template, 2, 1, \"ng-container\", 26)(7, PostComponent_ng_container_44_ng_template_7_Template, 1, 0, \"ng-template\", null, 1, i0.ɵɵtemplateRefExtractor);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(9, \"button\", 27)(10, \"mat-icon\");\n    i0.ɵɵtext(11, \"share\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(12, \"button\", 28);\n    i0.ɵɵlistener(\"click\", function PostComponent_ng_container_44_Template_button_click_12_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.checkBookmark());\n    });\n    i0.ɵɵtemplate(13, PostComponent_ng_container_44_ng_container_13_Template, 3, 0, \"ng-container\", 26)(14, PostComponent_ng_container_44_ng_template_14_Template, 2, 0, \"ng-template\", null, 2, i0.ɵɵtemplateRefExtractor);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const viewTemplate_r4 = i0.ɵɵreference(8);\n    const bookmarkTemplate_r5 = i0.ɵɵreference(15);\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(5, _c3, ctx_r1.post.uuid));\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.post.comments > 0 || ctx_r1.post.status === \"ARCHIVED\")(\"ngIfElse\", viewTemplate_r4);\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.post.user_bookmark == null ? null : ctx_r1.post.user_bookmark.id)(\"ngIfElse\", bookmarkTemplate_r5);\n  }\n}\nexport let PostComponent = /*#__PURE__*/(() => {\n  class PostComponent {\n    constructor(postService, dialog) {\n      this.postService = postService;\n      this.dialog = dialog;\n      this.showFooter = true;\n      this.user_vote = 0;\n    }\n    ngOnInit() {\n      this.user_vote = this.post?.user_vote?.vote;\n    }\n    upvoteClicked() {\n      if (!this.user_id) return;\n      if (this.user_vote == 1) {\n        this.removeVote();\n      } else {\n        this.upvote();\n      }\n    }\n    downvoteClicked() {\n      if (!this.user_id) return;\n      if (this.user_vote == -1) {\n        this.removeVote();\n      } else {\n        this.downvote();\n      }\n    }\n    upvote() {\n      this.postService.upvotePost(this.post.uuid).subscribe(response => {\n        this.setVoteData(response);\n      }, err => {\n        console.log(err);\n      });\n    }\n    downvote() {\n      this.postService.downvotePost(this.post.uuid).subscribe(response => {\n        this.setVoteData(response);\n      }, err => {\n        console.log(err);\n      });\n    }\n    removeVote() {\n      this.postService.removePostVote(this.post.uuid).subscribe(response => {\n        this.setVoteData(response);\n      }, err => {\n        console.log(err);\n      });\n    }\n    setVoteData(response) {\n      this.user_vote = response?.vote;\n      this.post.votes = response?.votes;\n    }\n    checkBookmark() {\n      if (this.post.user_bookmark) {\n        this.removeBookmark();\n      } else {\n        this.addBookmark();\n      }\n    }\n    removeBookmark() {\n      this.postService.removeBookmark(this.post.uuid, this.post.user_bookmark.id).subscribe(response => {\n        this.post.user_bookmark = null;\n      }, err => {\n        console.log(err);\n      });\n    }\n    addBookmark() {\n      const data = {\n        user: this.user_id\n      };\n      this.postService.addBookmark(this.post.uuid, data).subscribe(response => {\n        this.post.user_bookmark = response;\n      }, err => {\n        console.log(err);\n      });\n    }\n    sharePost(uuid) {}\n    report() {\n      if (!this.user_id) {\n        this.redirectToLogin();\n        return;\n      } else {\n        const dialogWidth = window.innerWidth <= 540 ? `90vw` : `527px`;\n        const dialogRef = this.dialog.open(ReportDialogComponent, {\n          width: dialogWidth,\n          maxWidth: dialogWidth,\n          data: {\n            user: this.user_id,\n            uuid: this.post.uuid,\n            url: `${window.location.href}`\n          }\n        });\n        dialogRef.afterClosed().subscribe(response => {\n          if (response) {\n            this.post.report = response;\n          }\n        });\n      }\n    }\n    redirectToLogin() {\n      window.location.href = `${environment.loginUrl}`;\n    }\n    static {\n      this.ɵfac = function PostComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || PostComponent)(i0.ɵɵdirectiveInject(i1.PostService), i0.ɵɵdirectiveInject(i2.MatDialog));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: PostComponent,\n        selectors: [[\"app-post\"]],\n        inputs: {\n          post: \"post\",\n          user_id: \"user_id\",\n          showFooter: \"showFooter\"\n        },\n        standalone: false,\n        decls: 45,\n        vars: 31,\n        consts: [[\"headerMenu\", \"matMenu\"], [\"viewTemplate\", \"\"], [\"bookmarkTemplate\", \"\"], [1, \"post-card\", 3, \"ngClass\"], [1, \"likes-section\"], [\"mat-icon-button\", \"\", 3, \"click\"], [1, \"large-icon\", 3, \"ngClass\"], [1, \"count-text\"], [1, \"card-content\"], [1, \"card-meta\"], [\"fxLayout\", \"row\", \"fxLayoutGap\", \"8px\", \"fxLayoutAlign\", \"start center\"], [\"alt\", \"\", \"src\", \"/static/assets/images/default_user.png\", 1, \"user-avatar\"], [\"class\", \"font-bold\", 4, \"ngIf\"], [3, \"routerLink\"], [1, \"timestamp\"], [2, \"display\", \"flex\", \"align-items\", \"center\"], [\"mat-icon-button\", \"\", 2, \"float\", \"right\", 3, \"matMenuTriggerFor\"], [\"mat-menu-item\", \"\", 3, \"click\"], [\"mat-menu-item\", \"\", \"disabled\", \"\"], [1, \"\", 3, \"routerLink\"], [4, \"ngIf\"], [1, \"font-bold\"], [3, \"innerHtml\"], [\"fxLayout\", \"row\", \"fxLayoutGap\", \"12px\", \"fxLayoutAlign\", \"start center\", 1, \"card-actions\"], [1, \"card-actions-icon\", 2, \"vertical-align\", \"middle\"], [1, \"sub-text\"], [4, \"ngIf\", \"ngIfElse\"], [\"mat-icon-button\", \"\", 1, \"card-actions-icon\"], [\"mat-icon-button\", \"\", 2, \"margin-left\", \"auto\", 3, \"click\"], [1, \"card-actions-icon\"]],\n        template: function PostComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            const _r1 = i0.ɵɵgetCurrentView();\n            i0.ɵɵelementStart(0, \"mat-card\", 3)(1, \"div\", 4)(2, \"button\", 5);\n            i0.ɵɵlistener(\"click\", function PostComponent_Template_button_click_2_listener() {\n              i0.ɵɵrestoreView(_r1);\n              return i0.ɵɵresetView(ctx.upvoteClicked());\n            });\n            i0.ɵɵelementStart(3, \"mat-icon\", 6);\n            i0.ɵɵtext(4, \"keyboard_arrow_up\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(5, \"span\", 7);\n            i0.ɵɵtext(6);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(7, \"button\", 5);\n            i0.ɵɵlistener(\"click\", function PostComponent_Template_button_click_7_listener() {\n              i0.ɵɵrestoreView(_r1);\n              return i0.ɵɵresetView(ctx.downvoteClicked());\n            });\n            i0.ɵɵelementStart(8, \"mat-icon\", 6);\n            i0.ɵɵtext(9, \"keyboard_arrow_down\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(10, \"div\", 8)(11, \"div\", 9)(12, \"div\", 10);\n            i0.ɵɵelement(13, \"img\", 11);\n            i0.ɵɵtemplate(14, PostComponent_span_14_Template, 3, 4, \"span\", 12);\n            i0.ɵɵelementStart(15, \"span\")(16, \"a\", 13);\n            i0.ɵɵtext(17);\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(18, \"span\", 14);\n            i0.ɵɵtext(19);\n            i0.ɵɵpipe(20, \"timeSince\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(21, \"div\", 15)(22, \"button\", 16)(23, \"mat-icon\");\n            i0.ɵɵtext(24, \"more_vert\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(25, \"mat-menu\", null, 0)(27, \"button\", 17);\n            i0.ɵɵlistener(\"click\", function PostComponent_Template_button_click_27_listener() {\n              i0.ɵɵrestoreView(_r1);\n              return i0.ɵɵresetView(ctx.report());\n            });\n            i0.ɵɵelementStart(28, \"mat-icon\");\n            i0.ɵɵtext(29, \"outlined_flag\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(30, \"span\");\n            i0.ɵɵtext(31);\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(32, \"button\", 18)(33, \"mat-icon\");\n            i0.ɵɵtext(34, \"visibility_off\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(35, \"span\");\n            i0.ɵɵtext(36, \"Hide\");\n            i0.ɵɵelementEnd()()()()();\n            i0.ɵɵelementStart(37, \"mat-card-title\")(38, \"a\", 19);\n            i0.ɵɵtext(39);\n            i0.ɵɵpipe(40, \"slice\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(41, \"mat-card-content\");\n            i0.ɵɵtemplate(42, PostComponent_ng_container_42_Template, 4, 7, \"ng-container\", 20)(43, PostComponent_ng_container_43_Template, 3, 3, \"ng-container\", 20);\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(44, PostComponent_ng_container_44_Template, 16, 7, \"ng-container\", 20);\n            i0.ɵɵelementEnd()();\n          }\n          if (rf & 2) {\n            const headerMenu_r6 = i0.ɵɵreference(26);\n            i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(21, _c0, ctx.post.status === \"ARCHIVED\"));\n            i0.ɵɵadvance(3);\n            i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(23, _c1, ctx.user_vote === 1));\n            i0.ɵɵadvance(3);\n            i0.ɵɵtextInterpolate(ctx.post.votes);\n            i0.ɵɵadvance(2);\n            i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(25, _c1, ctx.user_vote === -1));\n            i0.ɵɵadvance(6);\n            i0.ɵɵproperty(\"ngIf\", ctx.post == null ? null : ctx.post.group);\n            i0.ɵɵadvance(2);\n            i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(27, _c2, ctx.post.author.username));\n            i0.ɵɵadvance();\n            i0.ɵɵtextInterpolate1(\"Posted by u/\", ctx.post.author.username);\n            i0.ɵɵadvance(2);\n            i0.ɵɵtextInterpolate1(\"\", i0.ɵɵpipeBind1(20, 15, ctx.post.created_at), \" ago\");\n            i0.ɵɵadvance(3);\n            i0.ɵɵproperty(\"matMenuTriggerFor\", headerMenu_r6);\n            i0.ɵɵadvance(9);\n            i0.ɵɵtextInterpolate((ctx.post == null ? null : ctx.post.report == null ? null : ctx.post.report.id) ? \"Redact\" : \"Report\");\n            i0.ɵɵadvance(7);\n            i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(29, _c3, ctx.post.uuid));\n            i0.ɵɵadvance();\n            i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind3(40, 17, ctx.post.title, 0, 100), \" \");\n            i0.ɵɵadvance(3);\n            i0.ɵɵproperty(\"ngIf\", ctx.post.content.length > 300);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.post.content.length <= 300);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.showFooter);\n          }\n        },\n        dependencies: [i3.NgClass, i3.NgIf, i4.MatIconButton, i5.MatCard, i5.MatCardContent, i5.MatCardTitle, i6.MatIcon, i7.MatMenu, i7.MatMenuItem, i7.MatMenuTrigger, i8.RouterLink, i3.SlicePipe, i9.SafeContentPipe, i10.TimeSincePipe],\n        styles: [\".post-card[_ngcontent-%COMP%]{box-shadow:none;border:1px solid #dedede;border-radius:8px;display:flex;padding:0;width:100%;margin:16px 0}.archived-card[_ngcontent-%COMP%]{background-color:#dcdcdc}.likes-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-right:10px;padding-left:10px;padding-top:20px;padding-right:10px}.likes-section[_ngcontent-%COMP%]   .count-text[_ngcontent-%COMP%]{font-size:.8rem;color:#707070;text-align:center}.card-content[_ngcontent-%COMP%]{padding:20px 20px 20px 0;width:inherit}.card-meta[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:6px;margin-bottom:12px;font-size:.7rem}.card-meta[_ngcontent-%COMP%]   .user-avatar[_ngcontent-%COMP%]{width:30px;height:30px;margin-right:8px}.card-meta[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child{font-weight:500}.card-meta[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:last-child{color:#707070}.timestamp[_ngcontent-%COMP%]{float:right;color:#707070}.card-actions[_ngcontent-%COMP%]   .card-actions-icon[_ngcontent-%COMP%]{color:#707070}.sub-text[_ngcontent-%COMP%]{font-size:.8rem;color:#707070;text-align:center;margin-right:10px}.large-icon[_ngcontent-%COMP%]{font-size:40px;height:40px;width:40px;color:#a19999;display:inherit;font-weight:700}.large-icon.active-icon[_ngcontent-%COMP%]{color:#dc281e!important}\"]\n      });\n    }\n  }\n  return PostComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}