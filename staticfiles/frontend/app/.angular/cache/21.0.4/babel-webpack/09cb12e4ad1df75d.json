{"ast":null,"code":"import { FormControl, FormGroup, Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@discussit/core/services/user/user.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/material/snack-bar\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nimport * as i6 from \"@angular/material/button\";\nimport * as i7 from \"@angular/material/form-field\";\nimport * as i8 from \"@angular/material/icon\";\nimport * as i9 from \"@angular/material/input\";\nconst _c0 = () => [\"../sign-up\"];\nfunction SignInComponent_span_32_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"Submit\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SignInComponent_span_33_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"Logging in...\");\n    i0.ɵɵelementEnd();\n  }\n}\nexport let SignInComponent = /*#__PURE__*/(() => {\n  class SignInComponent {\n    constructor(userService, router, snackbar) {\n      this.userService = userService;\n      this.router = router;\n      this.snackbar = snackbar;\n      this.isLoading = false;\n      this.hidePassword = true;\n    }\n    ngOnInit() {\n      this.loginForm = new FormGroup({\n        username: new FormControl('', {\n          validators: [Validators.required]\n        }),\n        password: new FormControl('', {\n          validators: [Validators.required]\n        })\n      });\n    }\n    toggleVisibility() {\n      this.hidePassword = !this.hidePassword;\n    }\n    onSubmit() {\n      console.log('Sign-in form submitted');\n      console.log('Form valid:', this.loginForm.valid);\n      console.log('Form values:', this.loginForm.value);\n      console.log('Form errors:', this.loginForm.errors);\n      console.log('Email control errors:', this.loginForm.get('email')?.errors);\n      console.log('Password control errors:', this.loginForm.get('password')?.errors);\n      if (!this.loginForm.valid) {\n        console.log('Form is invalid, not submitting');\n        this.snackbar.open('Please fill in all required fields', 'Close', {\n          duration: 3000\n        });\n        return;\n      }\n      const loginData = {\n        username: this.loginForm.value.username,\n        password: this.loginForm.value.password\n      };\n      console.log('Sending login request with data:', loginData);\n      this.isLoading = true;\n      this.userService.login(loginData).subscribe(result => {\n        console.log('Login successful:', result);\n        this.isLoading = false;\n        // Store the auth token if provided\n        if (result.key) {\n          localStorage.setItem('auth_token', result.key);\n          console.log('Auth token stored:', result.key);\n        }\n        // Fetch user profile after successful login\n        this.userService.getAuthUser(user => {\n          console.log('User profile fetched after login:', user);\n          if (user) {\n            this.userService.setUser(user);\n          }\n        });\n        this.snackbar.open('Successfully logged in', 'Close', {\n          duration: 3000\n        });\n        this.router.navigate(['']);\n      }, err => {\n        console.error('Login error:', err);\n        console.error('Error details:', JSON.stringify(err, null, 2));\n        this.isLoading = false;\n        if (err.error) {\n          if (err.error.non_field_errors) {\n            this.snackbar.open(err.error.non_field_errors[0], 'Close', {\n              duration: 5000\n            });\n          } else if (err.error.email) {\n            this.snackbar.open(err.error.email[0], 'Close', {\n              duration: 5000\n            });\n          } else {\n            this.snackbar.open('Login failed. Please try again.', 'Close', {\n              duration: 5000\n            });\n          }\n        } else {\n          this.snackbar.open('Network error. Please check your connection.', 'Close', {\n            duration: 5000\n          });\n        }\n      });\n    }\n    onGoogleLogin() {\n      console.log('Google login clicked');\n      this.snackbar.open('Google login is not configured yet. Please contact the administrator.', 'Close', {\n        duration: 5000\n      });\n      // TODO: Implement Google OAuth when client credentials are configured\n      // window.location.href = `${environment.serverUrl}/accounts/google/login/`;\n    }\n    onFacebookLogin() {\n      console.log('Facebook login clicked');\n      this.snackbar.open('Facebook login is not configured yet. Please contact the administrator.', 'Close', {\n        duration: 5000\n      });\n      // TODO: Implement Facebook OAuth when app credentials are configured\n      // window.location.href = `${environment.serverUrl}/accounts/facebook/login/`;\n    }\n    static {\n      this.ɵfac = function SignInComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || SignInComponent)(i0.ɵɵdirectiveInject(i1.UserService), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i3.MatSnackBar));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: SignInComponent,\n        selectors: [[\"app-sign-in\"]],\n        standalone: false,\n        decls: 38,\n        vars: 10,\n        consts: [[1, \"auth-container\"], [1, \"login-form\"], [\"align\", \"center\", 1, \"text-white\"], [1, \"buttons-section\"], [\"mat-button\", \"\", 1, \"custom-button\", 2, \"border-color\", \"rgb(255, 92, 136)\", 3, \"click\"], [\"mat-button\", \"\", 1, \"custom-button\", 2, \"border-color\", \"rgb(255, 192, 93)\", 3, \"click\"], [1, \"separator-section\"], [1, \"divider-left\"], [\"align\", \"center\"], [1, \"divider-right\"], [\"autocomplete\", \"off\", 1, \"auth-form\", 3, \"ngSubmit\", \"formGroup\"], [1, \"width-100\", \"margin-bottom-4\"], [\"for\", \"username\"], [\"matInput\", \"\", \"id\", \"username\", \"placeholder\", \"john_doe\", \"formControlName\", \"username\", \"type\", \"text\", \"required\", \"\", 1, \"form-input\"], [1, \"\"], [1, \"width-100\", \"margin-bottom-4\", 2, \"position\", \"relative\"], [\"for\", \"password\"], [\"matInput\", \"\", \"id\", \"password\", \"placeholder\", \"wonderfullemon dankworld\", \"formControlName\", \"password\", \"required\", \"\", 1, \"form-input\", 3, \"type\"], [\"type\", \"button\", \"mat-icon-button\", \"\", \"matSuffix\", \"\", 1, \"toggle-visibility-btn\", 3, \"click\"], [\"type\", \"submit\", \"mat-button\", \"\", \"color\", \"primary\", 1, \"margin-top-4\", \"width-100\", \"custom-button\", \"block-button\", \"submit-button\", 3, \"disabled\"], [4, \"ngIf\"], [1, \"underline\", \"button-link\", 3, \"routerLink\"]],\n        template: function SignInComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"h2\", 2);\n            i0.ɵɵtext(3, \"Sign in to DiscussIt\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(4, \"div\", 3)(5, \"button\", 4);\n            i0.ɵɵlistener(\"click\", function SignInComponent_Template_button_click_5_listener() {\n              return ctx.onGoogleLogin();\n            });\n            i0.ɵɵelementStart(6, \"mat-icon\");\n            i0.ɵɵtext(7, \"account_circle\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(8, \" Google \");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(9, \"button\", 5);\n            i0.ɵɵlistener(\"click\", function SignInComponent_Template_button_click_9_listener() {\n              return ctx.onFacebookLogin();\n            });\n            i0.ɵɵelementStart(10, \"mat-icon\");\n            i0.ɵɵtext(11, \"facebook\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(12, \" Facebook \");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(13, \"div\", 6);\n            i0.ɵɵelement(14, \"div\", 7);\n            i0.ɵɵelementStart(15, \"p\", 8);\n            i0.ɵɵtext(16, \"OR\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(17, \"div\", 9);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(18, \"form\", 10);\n            i0.ɵɵlistener(\"ngSubmit\", function SignInComponent_Template_form_ngSubmit_18_listener() {\n              return ctx.onSubmit();\n            });\n            i0.ɵɵelementStart(19, \"div\", 11)(20, \"label\", 12);\n            i0.ɵɵtext(21, \"Username\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(22, \"input\", 13);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(23, \"div\", 14);\n            i0.ɵɵelementStart(24, \"div\", 15)(25, \"label\", 16);\n            i0.ɵɵtext(26, \"Password\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(27, \"input\", 17);\n            i0.ɵɵelementStart(28, \"button\", 18);\n            i0.ɵɵlistener(\"click\", function SignInComponent_Template_button_click_28_listener() {\n              return ctx.toggleVisibility();\n            });\n            i0.ɵɵelementStart(29, \"mat-icon\");\n            i0.ɵɵtext(30);\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(31, \"button\", 19);\n            i0.ɵɵtemplate(32, SignInComponent_span_32_Template, 2, 0, \"span\", 20)(33, SignInComponent_span_33_Template, 2, 0, \"span\", 20);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(34, \"p\");\n            i0.ɵɵtext(35, \"Haven't registered yet? \");\n            i0.ɵɵelementStart(36, \"a\", 21);\n            i0.ɵɵtext(37, \"Sign Up\");\n            i0.ɵɵelementEnd()()()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(18);\n            i0.ɵɵproperty(\"formGroup\", ctx.loginForm);\n            i0.ɵɵadvance(9);\n            i0.ɵɵproperty(\"type\", ctx.hidePassword ? \"password\" : \"text\");\n            i0.ɵɵadvance();\n            i0.ɵɵattribute(\"aria-label\", \"Hide password\")(\"aria-pressed\", ctx.hidePassword);\n            i0.ɵɵadvance(2);\n            i0.ɵɵtextInterpolate(ctx.hidePassword ? \"visibility_off\" : \"visibility\");\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"disabled\", ctx.isLoading);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", !ctx.isLoading);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.isLoading);\n            i0.ɵɵadvance(3);\n            i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(9, _c0));\n          }\n        },\n        dependencies: [i4.NgIf, i5.ɵNgNoValidate, i5.DefaultValueAccessor, i5.NgControlStatus, i5.NgControlStatusGroup, i5.RequiredValidator, i5.FormGroupDirective, i5.FormControlName, i6.MatButton, i6.MatIconButton, i7.MatSuffix, i8.MatIcon, i9.MatInput, i2.RouterLink],\n        styles: [\".width-100[_ngcontent-%COMP%]{width:100%}.auth-container[_ngcontent-%COMP%]{background-color:brown;background-repeat:no-repeat;background-size:cover;display:flex;width:100vw;height:100vh;flex-direction:column;justify-content:center;align-items:center}.login-form[_ngcontent-%COMP%]{max-width:400px;width:100%;color:#fff;padding:16px;display:block}.login-form[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{margin:6px 0}.form-input[_ngcontent-%COMP%]{outline:none;border:1px solid #e6e6e6;padding:16px 12px;margin:8px 0;font-size:.8rem;width:-webkit-fill-available;display:inline-flex;background:transparent;border-radius:6px;color:#fff}.form-input[_ngcontent-%COMP%]::placeholder{color:inherit}.custom-button[_ngcontent-%COMP%]{outline:none;border:1px solid white;margin-top:12px;margin-bottom:12px;font-size:.8rem;color:#fff;border-radius:6px;background:transparent;width:50%;padding:2px}.custom-button.block-button[_ngcontent-%COMP%]{width:100%}.custom-button[_ngcontent-%COMP%]:hover, .custom-button[_ngcontent-%COMP%]:focus{background:#fff3}.custom-button[_ngcontent-%COMP%]:disabled{background-color:#e6e6e6;color:#707070;cursor:not-allowed}.custom-button.submit-button[_ngcontent-%COMP%]{display:block;margin-left:auto;margin-right:auto}.text-white[_ngcontent-%COMP%]{color:#fff}label[_ngcontent-%COMP%]{font-size:14px}.buttons-section[_ngcontent-%COMP%]{display:flex;gap:20px;justify-content:center}.separator-section[_ngcontent-%COMP%]{display:flex;width:100%;margin-top:20px;margin-bottom:12px;justify-content:center;align-items:center;border-radius:1px}.separator-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.button-link[_ngcontent-%COMP%]{outline:none;border:1px solid white;margin-top:12px;margin-bottom:12px;font-size:.8rem;color:#fff;border-radius:6px;background:transparent;width:33%;padding:6px;text-decoration:none;cursor:pointer}.divider-left[_ngcontent-%COMP%]{display:block;height:1px;margin-right:11px;margin-left:11px;flex:1 1 0%;background-image:linear-gradient(90deg,#e9edf100 35%,#a1a5be);border-radius:2px}.divider-right[_ngcontent-%COMP%]{display:block;height:1px;margin-right:11px;margin-left:11px;flex:1 1 0%;background-image:linear-gradient(90deg,#e9edf100 35%,#a1a5be);border-radius:2px;transform:rotate(180deg)}.toggle-visibility-btn[_ngcontent-%COMP%]{position:absolute;right:6px;top:33px;background:transparent;color:#fff}\"]\n      });\n    }\n  }\n  return SignInComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}